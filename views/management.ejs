<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />

    <meta name="author" content="Webpixels" />
    <title>Trainity - Admin Panel</title>
    <!-- Favicon -->
    <link rel="icon" href="../img/custom/favicon-32x32.jpg" type="image/png" />
    <!-- Font Awesome 5 -->
    <link
      rel="stylesheet"
      href="../libs/@fortawesome/fontawesome-free/css/all.min.css"
    />
    <!-- Purpose CSS -->
    <link rel="stylesheet" href="../css/purpose.css" id="stylesheet" />
    <!-- Font Awesome 5 -->
    <link
      rel="stylesheet"
      href="../libs/@fortawesome/fontawesome-free/css/all.min.css"
    />
    <!-- Page CSS -->
    <link
      rel="stylesheet"
      href="../libs/fullcalendar/dist/fullcalendar.min.css"
    />

    <link rel="stylesheet" href="//cdn.quilljs.com/1.3.6/quill.bubble.css" />
    <style>
    body {
    font-family: 'Manrope', sans-serif !important;
        }
      
    
.green {
    cursor: pointer;
    height: 22px;
    font-style: normal;
    font-weight: 600;
    font-size: 16px;
    line-height: 22px;
    color: #48BF84;
}
.datepicker-wrapper input[type="date"]::-webkit-calendar-picker-indicator {
    position: relative;
    opacity: 0;
  }
  input[type="date"]
{
    display:block;
    -webkit-appearance: textfield;
    -moz-appearance: textfield;
    min-height: 1.2em;
}
  .datepicker-wrapper input[type="date"]::before {
    content:  url(../img/d_calendar_black_big.svg) ;
    display: inline-block;
    width: 20px;
    height: 20px;
    position: absolute;
    left: 0;
  }
.textarea {
    border: none;
    width: 100%;
    padding: 10px
}

.heading {
   font-style: normal;
    font-weight: 600;
    font-size: 14px;
    line-height: 19px;
    color: #000000;
}

.rounded-list {
    list-style: none;
    counter-reset: item;
    padding-left: 0;
}

.rounded-list li {
    position: relative;
    margin-bottom: 1px;
    padding-left: 40px;
    font-size: 14px;
    line-height: 1.5;
    font-weight: 600;
}

.box {
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding: 10px 10px;
    gap: 1px;
    background: #ffffff;
    border: 1px solid #dcdcdc;
    border-radius: 14px;
}

.rounded-list li:before {
    content: counter(item);
    counter-increment: item;
    position: absolute;
    left: 0;
    top: 0;
    width: 25px;
    height: 25px;
    border-radius: 50%;
    background-color: #fff;
    border: 2px solid #000;
    color: #000;
    text-align: center;
    line-height: 25px;
}

.black {
    background-color: #000;
}

.text-black {
    color: black;
}

.yellow {
    background-color: #FDECAA;
}

.orange {
    background-color: #FFFBEB;
}

.success {
    background-color: #F2FAF6;
}

.normal {
    background-color: #FAFAFA; ;
}

.text-normal {
    color: '#898989';
}

.text-success {
    color: #48BF84;
    cursor: pointer;
}

.p {
    width: 169.32px;
    height: 28px;
    margin-top: -8px;
    font-style: normal;
    font-weight: 400;
    font-size: 12px;
    line-height: 14px;
}

.activeTab {
    background: #F2FAF6;
}

.navbar {
    display: flex;
    justify-content: space-between;
}

.navbar-toggle {
    display: none;
    flex-direction: column;
    justify-content: space-between;
    cursor: pointer;
}

.navbar-toggle span {
    width: 30px;
    height: 3px;
    background-color: #000;
}



.list-group-item {
    margin: 5px;
    border-radius: 12px;
}

.navbartop {
    display: none;
}

.datepicker-wrapper {
    position: relative;
}

.rating-button-web {
    display: block !important;
}

.rating-button-mobile {
    display: none !important;
}
.taskvideobox{
  padding:24px;
  display:flex;
}
.ratingcard{
  padding:20px!important;
}
.videoNotUploaded{
 color:#48BF84;
 font-weight: 700;
font-size: 32px;
line-height: 24px;
margin:auto;
margin-top:20px
}


    .updownarrow {
        display: none !important;
    }

   

    .cardbutton {
        display: flex !important;
    }

    .mobile-navbar {
        display: none !important;
    }

.task-color {
    background-color: #F4F5FB;
}

.text-disabled {
    color: #DCDCDC;
}

.btn-status-green {
    padding: 5px 10px;
    border-radius: 14px;
    color: var(--pill-text-blue, #3B82F6);
    font-size: 12px;
    font-weight: 600;
    letter-spacing: 0.24px;
    border-radius:8px;
    border-bottom: 1px solid  #ECECEC;
    background:#F4F5FB
}

.btn-status-red {
  padding: 5px 10px;
    border-radius: 14px;
    align-items: flex-start;
    font-size: 12px;
    font-weight: 600;
    border-radius:8px;
    letter-spacing: 0.24px;
    background:  #EBEBEB;
}

.videoTab {
  display: flex;
padding: 16px;
flex-direction: column;
justify-content: center;
align-items: center;
gap: 8px;
flex: 1 0 0;
border-radius: 14px 0px 0px 14px;
border: 1px solid var(--stroke-primary, #ECECEC);
}
.videoTabBody{
display: flex;
gap: 10px;
justify-content: center;
padding:16px 16px 0 16px;
border-radius: 14px 0px 0px 14px;
font-size: 12px;
}
.datevalue{
    font-style: normal;
    font-weight: 700;
    font-size: 20px;
    line-height: 24px;
    padding-left:45px;
    display: flex;
    align-items: center;
    color: #000000;
}
.modal-user-profile{
  width: 64px;
  height: 64px;
  border-radius: 61.2787px;              
}
.modal-header-name{
  font-size:24px;
  font-weight:700;
  color: #48bf84
}
.modal-header-title{
    width: 649px;
    height: 27px;
    font-style: normal;
    margin-left: 10px;
    font-weight: 700;
    font-size: 20px;
    line-height: 27px;
    color: #181818;
}
.modal-tasks-img{
  width: 24px;
height: 24px;
}
.badges-button-body{
  display: flex;
height: 69px;
padding: 8px;
justify-content: center;
align-items: center;
gap: 8px;
border-radius: 8px;
border: 1px solid var(--stroke-secondary, #DCDCDC);
background: var(--surface-primary, #FFF);
}
.rating-button-body{
  display: flex;
padding: 6px 16px;
flex-direction: column;
justify-content: center;
align-items: center;
gap: 4px;
border-radius: 12px;
}
.modal-badges-meter-col{
  display: flex;
flex-direction: row;
padding: 24px;
align-items: flex-start;
justify-content: space-between;
width:280px;
border-radius: 12px;
border: 1px solid  #ECECEC;
background: #ECECEC;
    font-size: 20px;
    font-weight: 600;
    line-height: 16px;
    color: black;
}
.modal-badges-meter-star{
  display:flex;
  flex-direction:row;
  gap:10px;
  color: #FACC15;
font-size: 16px;
font-weight: 700;
}


.borderless-number-input {
  border: none;
  width:40px;
  text-align: center;
  -moz-appearance: textfield; /* Firefox */
}

.borderless-number-input::-webkit-inner-spin-button,
.borderless-number-input::-webkit-outer-spin-button {
  -webkit-appearance: none;
  margin: 0;
}
@media (max-width: 768px ) {
  .closeButton{
    display:none !important;
  }
  .taskvideobox{
  padding:10px;
  display:flex;
}
  .modal-tasks-img{
  width: 18px;
height: 18px;
}
    .rating-button-body {
      display:flex;
      width:100%;
      padding:0px;
    }
    .starbox {
        display: flex;
        flex-wrap: wrap;
    }

    .navbar-toggle {
        display: flex;
    }

    .modal-header {
        display: flex;
        flex-direction: column;
    }

    .youtube {
        width: 300px;
        height: 200px;
    }

    #datevalue {
        padding-left: 0 !important;
    }

    #navcontainer {
        display: none;
    }

    .rating-button {
        width: 300px;
        height: 70px;
        margin: auto;
    }

    .rating-box {
        display: flex;
        flex-direction: column;
        margin: 10px 0px;
    }

    .navbartop {
        display: flex;
        /* show navbar */
        align-items: center;
    }

    .cardbutton {
        display: none;
    }

    .containers {
        display: none;
    }

    .list-item {
        width: 340px;
        /* set width to 320px */
    }

    .navbarcard {
        margin: 20px;
    }

    .updownarrow {
        display: block !important;
    }

    .mobile-header {
        display: flex !important;
    }

    .text {
        display: none !important;
    }

    .mobile-navbar {
        display: block !important;
    }

    .navbtn {
        color: white
    }
    .modal-user-profile{
  width: 48px;
  height: 48px;
  border-radius: 61.2787px;              
}
.modal-header-name{
  font-size:20px;
  font-weight:600;
  color: #48bf84
}
.modal-header-title{        
    margin-left: 10px;
    font-weight: 700;
    font-size: 16px;
    line-height: 27px;
    color: #181818;
}
.videoTabBody{
  display: flex;
padding: 8px;
flex-direction: row;
justify-content: center;
align-items: center;
gap: 4px;
flex: 1 0 0;
border-radius: 14px 0px 0px 14px;
}
.btn-status-green {
  display: flex;
padding: 4px 8px;
align-items: flex-start;
gap: 8px;
border-radius: 8px;
background: var(--pill-surface-blue, #F4F5FB);
}

.btn-status-red {
  border-radius: 8px;
background: var(--surface-fourth, #EBEBEB);
display: flex;
padding: 4px 8px;
align-items: flex-start;
gap: 8px;
}
.videoNotUploaded{
 color:#48BF84;
 font-weight: 600;
font-size: 22px;
line-height: 24px;
margin:auto;
margin-top:20px
}
.rating-badges-body{
padding: 24px;
align-items: center;
width:100%;
border-radius: 12px;
background: var(--surface-primary, #FFF);
}
.ratingcard{
  padding:0px!important;
}
.badges-button-body{
  margin-bottom:20px;
}
.tabs{
  display:flex;
  margin:0px;
}

}
@media (min-width: 767px) {
  .tabs{
    display: flex;
    margin-right: -10px;
    margin-left: -10px;
}
  .rating-badges-body{
  display: flex;
padding: 24px;
flex-direction: row;
align-items: flex-start;
gap: 24px;
flex: 1 0 0;
align-self: stretch;
border-radius: 12px;
justify-content:space-between;
background: var(--surface-primary, #FFF);
}
    #navcontainer {
      display: flex !important;
      flex-direction: row;
      justify-content: space-around;
      flex-flow: wrap;
    }

    .updownarrow {
      display: none !important;
    }

    

    .cardbutton {
      display: flex !important;
    }

    .mobile-navbar {
      display: none !important;
    }
}

    </style>
    <!-- Hotjar Tracking Code for Admin Website -->
<script>
  (function(h,o,t,j,a,r){
      h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
      h._hjSettings={hjid:3534926,hjsv:6};
      a=o.getElementsByTagName('head')[0];
      r=o.createElement('script');r.async=1;
      r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
      a.appendChild(r);
  })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>
  </head>

  <body class="application application-offset" style="background:white;margin-left:300px;width: calc(100vw - 300px);padding:0 32px;" id="MainPageContent">
  
    <!-- Chat modal -->

    <!-- Application container -->
    <div >
      <!-- Sidenav -->
      <div >
      <%- include('partials/sidepanel'); -%>
      </div>
      <!-- Content -->
      <div class="main-content position-relative" style="padding: 0px;margin: 0px;">
      
        <div class="page-content">
          <%- include('partials/utility-modals'); -%>
          <!-- Page title -->
          <div class="page-title">
            <div class="row">
            
              <div class="card" style="width: 100%;">
                <div class="card-body">
                 <div class="navbartop" style="width:350px;font-size:17px;font-weight:600;justify-content:space-between;color:black" onclick="changeposition()"> Manage other things  
                  <i
                  class="fa fa-angle-up"
                  id="icon"  
                  style="margin-right:20%;"></i>
              </div>
                  <div
                    class="list-group" id="navcontainer"
                  >
                    <!-- <div
                      class="list-group-item"
                      style=" margin: 5px; border-radius: 12px"
                    >
                      <a href="/mark/performance">
                        <div class="media align-items-center">
                          <div class="mr-3">
                            <img
                              alt="Image placeholder"
                              src="../img/svg/illustrations/work-chat.svg"
                              class="avatar rounded-circle"
                            />
                          </div>
                          <div class="media-body ">
                            <h6 class="text-sm d-block mb-0">
                              Mark Performance
                            </h6>
                          </div>
                        </div>
                      </a>
                    </div>

                    <div
                      class="list-group-item"
                      style=" margin: 5px; border-radius: 12px"
                    >
                      <a href="/add/badges">
                        <div class="media align-items-center">
                          <div class="mr-3">
                            <img
                              alt="Image placeholder"
                              src="../img/gem.svg"
                              class="avatar rounded-circle"
                            />
                          </div>
                          <div class="media-body ">
                            <h6 class="text-sm d-block  mb-0">
                              Add Badges
                            </h6>
                          </div>
                        </div>
                      </a>
                    </div> -->

                    <div
                      class="list-group-item"
                      style=" margin: 5px; border-radius: 12px"
                    >
                      <a href="/AddorAssign/employee">
                        <div class="media align-items-center">
                          <div class="mr-3">
                            <img
                              alt="Image placeholder"
                              src="../img/svg/illustrations/teaching.svg"
                              class="avatar rounded-circle"
                            />
                          </div>
                          <div class="media-body ">
                            <h6 class="text-sm d-block  mb-0">
                              Assign / Add Employee
                            </h6>
                          </div>
                        </div>
                      </a>
                    </div>
                    <div
                      class="list-group-item"
                      style=" margin: 5px; border-radius: 12px"
                    >
                      <a href="/allemployee/project">
                        <div class="media align-items-center">
                          <div class="mr-3">
                            <img
                              alt="Image placeholder"
                              src="../img/svg/illustrations/design-thinking.svg"
                              class="avatar rounded-circle"
                            />
                          </div>
                          <div class="media-body ">
                            <h6 class="text-sm d-block mb-0">
                              Create Project for multiple people
                            </h6>
                          </div>
                        </div>
                      </a>
                    </div>
                    <div
                      class="list-group-item"
                      style=" margin: 5px; border-radius: 12px"
                    >
                      <a href="/create/level">
                        <div class="media align-items-center">
                          <div class="mr-3">
                            <img
                              alt="Image placeholder"
                              src="../img/svg/illustrations/instruction-manual.svg"
                              class="avatar rounded-circle"
                            />
                          </div>
                          <div class="media-body ">
                            <h6 class="text-sm d-block  mb-0">
                              Create Levels
                            </h6>
                          </div>
                        </div>
                      </a>
                    </div>
                    <div
                      class="list-group-item"
                      style=" margin: 5px; border-radius: 12px"
                    >
                      <a href="/create/dailyTask">
                        <div class="media align-items-center">
                          <div class="mr-3">
                            <img
                              alt="Image placeholder"
                              src="../img/svg/illustrations/monitor.svg"
                              class="avatar rounded-circle"
                            />
                          </div>
                          <div class="media-body ">
                            <h6 class="text-sm d-block mb-0">
                              Create Daily Tasks
                            </h6>
                          </div>
                        </div>
                      </a>
                    </div>
                    <!-- <div
                      class="list-group-item"
                      style=" margin: 5px; border-radius: 12px"
                    >
                      <a href="/admin/create">
                        <div class="media align-items-center">
                          <div class="mr-3">
                            <img
                              alt="Image placeholder"
                              src="../img/svg/illustrations/work-chat.svg"
                              class="avatar rounded-circle"
                            />
                          </div>
                          <div class="media-body ">
                            <h6 class="text-sm d-block  mb-0">
                              Add Intern
                            </h6>
                          </div>
                          <div class="media-body text-right"></div>
                        </div>
                      </a>
                    </div>
                  -->
                  </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <% function ChangeDate(date) {
            const options = { day: "numeric", month: "long", year: "numeric" };
            const formattedDate = new Date(date).toLocaleDateString(undefined, options);
            return formattedDate;
          } %>
          <!-- <div class="card px-4 py-5">
            <div class="container">
                <div class="row justify-content-center">
                    <% for(let i=0; i<employeeList.length; i++) { %>
                        <a  href="/performanceBoard/<%= employeeList[i]._id %>" class="btn btn-primary"><%= employeeList[i].firstName + " " + employeeList[i].lastName %> <i class="fas fa-external-link-square-alt ml-1"></i> </a>
                    <% } %> 
                </div>
            </div>
          </div> -->

         
          <div class="card" style=" padding: 30px 25px">
            <% for(let leaves of leaveIssues) {%>
            <div class="card" style="display: flex;
            padding: 20px 24px;
            flex-direction: row;
            align-items: center;
            justify-content: space-between;
            align-self: stretch;
            border-radius: 8px;" onmouseover="showIcons('Leavesdelete-<%=leaves.leaveIssue._id%>')" onmouseout="removeIcons('Leavesdelete-<%=leaves.leaveIssue._id%>')" id="leaveissuebox-<%=leaves.leaveIssue._id%>">
            <div style="display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 12px;">
            <div style="display: flex;justify-content: flex-start; gap:10px">
              <% const issueDate = ChangeDate(leaves.leaveIssue.date); %>
            <img src="../img/icons performance mgmt/desktop/d_calendar_black_big.svg">
            <div style="color: var(--content-on-light-primary, #181818);
            font-size: 20px;
            font-style: normal;
            font-weight: 600;
            line-height: 20px;"> Leave Issue -  <%=issueDate%></div>
            </div>
              <div style="color: var(--gray-500, #667085);
              font-size: 14px;
              font-style: normal;
              font-weight: 500;
              line-height: 24px; /* 171.429% */
              letter-spacing: 0.21px;">Issue Raised By - <%=leaves.admin.displayName%></div>
          
            <div style="color: #1E1E1E;
            font-size: 14px;
            font-style: normal;
            font-weight: 600;
            line-height: normal;"><%=leaves.leaveIssue.reason%></div>
           
           <div style="color: #48BE83;
           font-size: 16px;
           font-style: normal;
           font-weight: 600;
           cursor: pointer;
           line-height: normal;"
    onclick="sendData('<%= JSON.stringify(leaves) %>', '<%=leaves.admin._id%>', '<%=leaves.leaveIssue.date%>')"  data-toggle="modal" data-target="#managerModalRating">
 Go to Updates
</div>
</div>
<img src="../img/icons performance mgmt/desktop/Delete_icon.svg"id="Leavesdelete-<%=leaves.leaveIssue._id%>" style="display: none;" onclick="DeleteRaiseIssueOnLeave('<%=leaves.leaveIssue._id%>','leaveissuebox-<%=leaves.leaveIssue._id%>')"> 
</div>

            <%}%>
            <% if(ratingReviewList.length>0){%>
          <div style="display: flex;align-items: center;justify-content: space-between;">
         <div style="color: #000;
         font-size: 20px;
         font-style: normal;
         font-weight: 700;
         line-height: 24px; ">Review Requests from Employees  </div>
<div style="display: flex;align-items: center;gap:10px">
  <input type="date"style="display: flex;
  padding: 12px 16px;
  justify-content: center;
  align-items: center;
  gap: 8px;
  border-radius: 8px;
  border: 1px solid var(--stroke-secondary, #DCDCDC);
  " id="RatingReviewSystemDate" onblur="filterItems()" >
  <div>
    <select  style="display: flex;
    padding: 12px 16px;
    justify-content: center;
    align-items: center;
    gap: 8px;
    border-radius: 8px;
    border: 1px solid var(--stroke-secondary, #DCDCDC);
    " id="RatingReviewStatus" onchange="filterItems()">
      <option value="all">All</option>   
<option value="pending" selected>Pending</option>
<option value="approved">Approved</option>
<option value="disappproved">Disapproved</option>
<option value="edited">Edited</option>

    </select>
  </div>
  
</div>
          </div>
        <div id="RatingReviewSystemBody">
              <%  ratingReviewList.map(item=>{ %>
                <% let adminPerformanceList=item.data.filter((employee)=>employee.ratingReview.status=='Pending');%>
            <% if(adminPerformanceList.length>0){%>
                <% const ratingeviewsDate = ChangeDate(item.date); %>
                <div style="color: #000;
            font-size: 20px;
            font-style: normal;
            font-weight: 700;
            line-height: 24px;margin:10px 0px; "><%=ratingeviewsDate%>
            </div>
          
            <div
            style="
            padding-top:5px;
              display: flex;
              flex-direction: row;
              justify-content: flex-start;
              flex-flow: wrap;
              margin-bottom: 20px;
            "
          >

                <% for(let i=0;i<adminPerformanceList.length;i++){%>
                  <% if(adminPerformanceList[i].ratingReview.status=='Pending'){%>
                <div
                  class="card"
                  style="
                    width: 320px;
                    background: #ffffff;
                    border: 1px solid #ececec;
                    border-radius: 20px;
                    margin:10px 10px;
                    overflow: hidden;
                  "
                >
                  <div
                    style="height: 60px;"
                    id="haderdiv"
                    class="<%= adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.taskStatus[3]? 'success' : adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.taskStatus[2] ? 'orange' :adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.taskStatus[1] ? 'task-color':'normal' %>">
                  
                    <div style="display: flex;
                    width:100%;
                    height: 100%;
                    align-items: flex-end;" >
                      <div style="height:100%;display: flex;
                      justify-content: center;
                      align-items: center"id='ratingdiv' class="<%=adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.rating > 0?' col-3 black' : 'col-3'%>">
                        <% if (adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.rating > 0) { %>
                          <%= adminPerformanceList[i].performanceRecord.rating %>
                        <% } %>
                        <img src="<%=adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.rating > 0?'../img/icons performance mgmt/desktop/d_star_full.svg':'../img/icons performance mgmt/desktop/d_star_empty.svg'%>" style="width: 20px; height: 20px; margin-left: 5px;margin-bottom:3px;" />
                      </div>
                      
                      <div class="col-6" style="display:flex;padding:10px 0px;">
                        <span style="font-size: 18px; font-weight: bold; margin:auto;" id="headertitle">
                          <% if (adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.taskStatus[3]) { %>
                            EOD <img src="../img/icons performance mgmt/desktop/d_header_eod_green.svg">
                          <% } else if (adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.taskStatus[2]) { %>
                            Noon <img src="../img/icons performance mgmt/desktop/d_header_noon_orange.svg">
                          <% } else if (adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.taskStatus[1]) { %>
                            Task <img src="../img/icons performance mgmt/desktop/d_header_task_blue.svg">
                          <% } else if (adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.taskStatus[0]) { %>
                            Sign In <img src="../img/icons performance mgmt/desktop/d_header_signin.svg">
                          <% } else { %>
                            No Status <img src="../img/icons performance mgmt/desktop/d_header_no_status.svg">
                          <% } %>
                        </span>
                        
                      </div>
                      <% let backgrooundColor=adminPerformanceList[i].ratingReview.status=='Pending'?'var(--pill-text-blue, #3B82F6)':'#48BF84'%>
                      <div style="height:100%;display: flex;
                      justify-content: center;
                      background: <%=backgrooundColor%>;
                      align-items: center"id='ratingdiv' class="col-3" >
                        <img src="../img/icons performance mgmt/desktop/ratingReview.svg" style="width: 20px; height: 20px; margin-left: 5px;margin-bottom:3px;" />
                      </div>
                    </div>
                  </div>
                  <div>
                    <div style="display: flex; gap: 20px; margin: 10px;justify-content: space-between;
                    align-items: center;">
                      <div>
                        <img
                          src=" <%= adminPerformanceList[i].admin.image %>"
                          id="userprofile"
                          style="
                            width: 64px;
                            height: 64px;
                            border-radius: 61.2787px;
                          "
                        />
                      </div>
                      <div
                        style="
                          width: 161.36px;
                          height: 49.5px;
                          font-style: normal;
                          font-weight: 700;
                          font-size: 18px;
                          line-height: 25px;
                          display: flex;
                          align-items: center;
                          color: #181818;
                        "
                        id="namediv"
                      >
                      <%= adminPerformanceList[i].admin.firstName %> <%= adminPerformanceList[i].admin.lastName %>
                      </div>
                      <%if(adminPerformanceList[i].performanceRecord){%>
                      <div style="margin-top: 15px ;background: #F7F7F7;width:21px;height:21px;color:black;border-radius: 20px;">
                        <a  href="/performanceBoard/<%= adminPerformanceList[i].performanceRecord.employeeID %>">
                        <img src="../img/icons performance mgmt/desktop/d_right_chevron_big.svg"/>
                      </a>
                      </div>
                      <%}%>
                    </div>
                    <div id="container<%=5000+i%>" class="containers" style="padding:2px 10px;">
                      <div style="display: flex;
                      margin: 10px;
                      flex-direction: row;
                      justify-content: space-between;
                      flex-wrap: wrap;">
                        <div style="display: flex; gap: 5px">
                          <div><img src="<%= adminPerformanceList[i].performanceRecord&&adminPerformanceList[i].performanceRecord.taskStatus[0] ? '../img/icons performance mgmt/desktop/d_signin_done_big.svg' : '../img/icons performance mgmt/desktop/d_signin_done_disabled_big.svg' %>" /></div>
                          <div class="text-black">Sign In</div>
                        </div>
                        <div>
                          <h6   class="<%= adminPerformanceList[i].performanceRecord&&adminPerformanceList[i].performanceRecord.taskStatus[0] ? 'text-black' : 'text-normal' %>"><%= adminPerformanceList[i].performanceRecord&&adminPerformanceList[i].performanceRecord.taskStatus[0] ? 'Done' : 'Incomplete' %></h6>
                        </div>
                        
                      </div>
                      <div style="display: flex;
                      margin: 10px;
                      flex-direction: row;
                      justify-content: space-between;
                      flex-wrap: wrap;">
                        <div style="display: flex; flex-direction: row; gap: 5px">
                          <div><img src="<%= adminPerformanceList[i].performanceRecord&&adminPerformanceList[i].performanceRecord.taskStatus[1] ? '../img/icons performance mgmt/desktop/d_tab_tasks_big.svg' : '../img/icons performance mgmt/desktop/d_tab_tasks_disabled_big.svg' %>" /></div>
                          <div class="text-black">Tasks</div>
                        </div>
                        <h6 class="<%= adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.taskStatus[1] ? 'green' : 'text-disabled' %>">
                          <% if (adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.links[1]) { %>
                            <a href="<%= adminPerformanceList[i].performanceRecord.links[1] %>"class='green' target="_blank">Check</a>
                          <% } else { %>
                            Check
                          <% } %>
                        </h6>
                      </div>
                      <div style="display: flex;
                      margin: 10px;
                      flex-direction: row;
                      justify-content: space-between;
                      flex-wrap: wrap;">
                        <div style="display: flex; flex-direction: row;gap:5px">
                          <div><img src="<%= adminPerformanceList[i].performanceRecord&&adminPerformanceList[i].performanceRecord.taskStatus[2] ? '../img/icons performance mgmt/desktop/d_noon_done_big.svg' : '../img/icons performance mgmt/desktop/d_noon_done_disabled_big.svg' %>" /></div>
                          <div class="text-black">Noon Update</div>
                        </div>
                        <h6 class="<%= adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.taskStatus[2] ? 'green' : 'text-disabled' %>">
                          <% if (adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.links[2]) { %>
                            <a href="<%= adminPerformanceList[i].performanceRecord.links[2] %>"class='green' target="_blank">Check</a>
                          <% } else { %>
                            Check
                          <% } %>
                        </h6>
                        
                      </div>
                      
                    </div>
                  </div>
                              <% let linksforsending=JSON.stringify(adminPerformanceList[i].performanceRecord.links) %>
                  <div id="cardbutton<%= 5000 + i %>" class="cardbutton" style="
                    display: flex;
                    flex-direction: row;
                    justify-content: center;
                    align-items: center;
                    font-weight: 600;
                    cursor: pointer;
                    margin: 10px;
                    height: 40px;
                    background-color: #48BF84;
                    color: white;
                    border-radius: 12px;"
                    data-target="#review-rating-modal"
                    data-toggle="modal"
                  
                    onclick="SetContentToModal(
                    '<%= adminPerformanceList[i].ratingReview.employeeId %>', '<%= adminPerformanceList[i].ratingReview.date %>'
                  )">

                    <img src="../img/icons performance mgmt/desktop/d_eod_active_big.svg"/> Check & Review
                </div>
                </div>
                <%}%>
                <%}%>
          
                </div>
                <%}%>
                <%})%>
              </div>
        <div style="color: var(--surface-button-primary, #48BF84);
        cursor: pointer;
        font-size: 20px;
        font-style: normal;
        font-weight: 600;
        margin: 0px 20px 20px 0px;
        line-height: normal;" data-target="#EmployeeSatisfactionModal" data-toggle="modal">
          Employee satisfaction
        </div>
<%}%>
            <div style="display: flex;
            justify-content: flex-start;
            align-items: center;">
              <div
              id="datevalue"
              class="datevalue"
              >
              
              
              <% const reviewsDate = ChangeDate(date); %>
              Give reviews for <%= reviewsDate %>
              </div>
              <div id="calendarImage" style="margin-left: 10px;margin-top:-5px">
                <div class="datepicker-wrapper" id="datepicker-box">
                  <!-- <label for="dateInput" style="width:30px"><img src="../img/gem.svg"></label> -->
                  <input type="date" id="dateInput" style="width:20px;height:0px; border: none; color: white">
              </div>
              
              </div>
            </div>
            <div
              style="
              padding-top:5px;
                 display: flex;
                flex-direction: row;
               
                justify-content: center;
                flex-flow: wrap;
              "
            >

            
            <% for(let i=0;i<adminPerformanceList.length;i++){%>
              <div
                class="card"
                style="
                  width: 320px;
                  background: #ffffff;
                  border: 1px solid #ececec;
                  border-radius: 20px;
                  margin:10px 10px;
                  overflow: hidden;
                "
              >
                <div
                  style="height: 60px;"
                  id="haderdiv"
                  class="<%= adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.taskStatus[3]? 'success' : adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.taskStatus[2] ? 'orange' :adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.taskStatus[1] ? 'task-color':'normal' %>">
                
                  <div style="display: flex;
                  width:100%;
                  height: 100%;
                  align-items: flex-end;" >
                    <div style="height:100%;display: flex;
                    justify-content: center;
                    align-items: center"id='ratingdiv' class="<%=adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.rating > 0?' col-3 black' : 'col-3'%>">
                      <% if (adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.rating > 0) { %>
                        <%= adminPerformanceList[i].performanceRecord.rating %>
                      <% } %>
                      <img src="<%=adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.rating > 0?'../img/icons performance mgmt/desktop/d_star_full.svg':'../img/icons performance mgmt/desktop/d_star_empty.svg'%>" style="width: 20px; height: 20px; margin-left: 5px;margin-bottom:3px;" />
                    </div>
                    
                    <div class="col-6" style="display:flex;padding:10px 0px;">
                      <span style="font-size: 18px; font-weight: bold; margin:auto;" id="headertitle">
                        <% if (adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.taskStatus[3]) { %>
                          EOD <img src="../img/icons performance mgmt/desktop/d_header_eod_green.svg">
                        <% } else if (adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.taskStatus[2]) { %>
                          Noon <img src="../img/icons performance mgmt/desktop/d_header_noon_orange.svg">
                        <% } else if (adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.taskStatus[1]) { %>
                          Task <img src="../img/icons performance mgmt/desktop/d_header_task_blue.svg">
                        <% } else if (adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.taskStatus[0]) { %>
                          Sign In <img src="../img/icons performance mgmt/desktop/d_header_signin.svg">
                        <% } else { %>
                          No Status <img src="../img/icons performance mgmt/desktop/d_header_no_status.svg">
                        <% } %>
                      </span>
                      
                    </div>
                    <div class="col" onclick="ChangeArrow('<%=i%>')">  <i
                      class="fa fa-angle-up updownarrow"  
                      style="margin-bottom:22px;margin-left: 20px;color:black"     
                      
                      id="icons<%= i %>"         
                    ></i> </div>
                  </div>
                </div>
                <div>
                  <div style="display: flex; gap: 20px; margin: 10px;justify-content: space-between;
                  align-items: center;">
                    <div>
                      <img
                        src=" <%= adminPerformanceList[i].admin.image %>"
                        id="userprofile"
                        style="
                          width: 64px;
                          height: 64px;
                          border-radius: 61.2787px;
                        "
                      />
                    </div>
                    <div
                      style="
                        width: 161.36px;
                        height: 49.5px;
                        font-style: normal;
                        font-weight: 700;
                        font-size: 18px;
                        line-height: 25px;
                        display: flex;
                        align-items: center;
                        color: #181818;
                      "
                      id="namediv"
                    >
                    <%= adminPerformanceList[i].admin.firstName %> <%= adminPerformanceList[i].admin.lastName %>
                    </div>
                    <%if(adminPerformanceList[i].performanceRecord){%>
                    <div style="margin-right: 20px ;background: #F7F7F7;width:21px;height:21px;color:black;border-radius: 20px;">
                      <a  href="/performanceBoard/<%= adminPerformanceList[i].performanceRecord.employeeID %>">
                      <img src="../img/icons performance mgmt/desktop/d_right_chevron_big.svg"/>
                    </a>
                    </div>
                    <%}%>
                  </div>
                  <div id="container<%=i%>" class="containers" style="padding:2px 10px;">
                    <div style="display: flex;
                    margin: 10px;
                    flex-direction: row;
                    justify-content: space-between;
                    flex-wrap: wrap;">
                      <div style="display: flex; gap: 5px">
                        <div><img src="<%= adminPerformanceList[i].performanceRecord&&adminPerformanceList[i].performanceRecord.taskStatus[0] ? '../img/icons performance mgmt/desktop/d_signin_done_big.svg' : '../img/icons performance mgmt/desktop/d_signin_done_disabled_big.svg' %>" /></div>
                        <div class="text-black">Sign In</div>
                      </div>
                      <div>
                        <h6   class="<%= adminPerformanceList[i].performanceRecord&&adminPerformanceList[i].performanceRecord.taskStatus[0] ? 'text-black' : 'text-normal' %>"><%= adminPerformanceList[i].performanceRecord&&adminPerformanceList[i].performanceRecord.taskStatus[0] ? 'Done' : 'Incomplete' %></h6>
                      </div>
                      
                    </div>
                    <div style="display: flex;
                    margin: 10px;
                    flex-direction: row;
                    justify-content: space-between;
                    flex-wrap: wrap;">
                      <div style="display: flex; flex-direction: row; gap: 5px">
                        <div><img src="<%= adminPerformanceList[i].performanceRecord&&adminPerformanceList[i].performanceRecord.taskStatus[1] ? '../img/icons performance mgmt/desktop/d_tab_tasks_big.svg' : '../img/icons performance mgmt/desktop/d_tab_tasks_disabled_big.svg' %>" /></div>
                        <div class="text-black">Tasks</div>
                      </div>
                      <h6 class="<%= adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.taskStatus[1] ? 'green' : 'text-disabled' %>">
                        <% if (adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.links[1]) { %>
                          <a href="<%= adminPerformanceList[i].performanceRecord.links[1] %>"class='green' target="_blank">Check</a>
                        <% } else { %>
                          Check
                        <% } %>
                      </h6>
                    </div>
                    <div style="display: flex;
                    margin: 10px;
                    flex-direction: row;
                    justify-content: space-between;
                    flex-wrap: wrap;">
                      <div style="display: flex; flex-direction: row;gap:5px">
                        <div><img src="<%= adminPerformanceList[i].performanceRecord&&adminPerformanceList[i].performanceRecord.taskStatus[2] ? '../img/icons performance mgmt/desktop/d_noon_done_big.svg' : '../img/icons performance mgmt/desktop/d_noon_done_disabled_big.svg' %>" /></div>
                        <div class="text-black">Noon Update</div>
                      </div>
                      <h6 class="<%= adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.taskStatus[2] ? 'green' : 'text-disabled' %>">
                        <% if (adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.links[2]) { %>
                          <a href="<%= adminPerformanceList[i].performanceRecord.links[2] %>"class='green' target="_blank">Check</a>
                        <% } else { %>
                          Check
                        <% } %>
                      </h6>
                      
                    </div>
                    
                  </div>
                </div>
                <% const currentTime = new Date(); %>
                <% const performancedate = new Date(date); %>
                <% const millisecondsInDay = 24 * 60 * 60 * 1000; %>
                             
                <div
                  id="cardbutton<%=i%>" class="cardbutton"
                <% let bgcolor='',textcolor='',cursor=''%>
                <% if (!adminPerformanceList[i].performanceRecord) { %>
                  <% if (performancedate.getTime() + millisecondsInDay < currentTime.getTime() ||currentTime.getHours() > 17 || (currentTime.getHours() === 17 && currentTime.getMinutes() >= 0)) { %>
                   <% bgcolor="#FDECAA;"%>
                   <% textcolor='black'%>
                  <% cursor='pointer'%>
                  <% } else { %>
                    <%  bgcolor="#EBEBEB;"%>
                    <% textcolor='#A7ADB9'%>
                  <% } %>
                <% } else if (adminPerformanceList[i].performanceRecord.taskStatus.length < 4 && !adminPerformanceList[i].performanceRecord.taskStatus[3]) { %>
                  <% if (performancedate.getTime() + millisecondsInDay < currentTime.getTime() ||currentTime.getHours() > 17 || (currentTime.getHours() === 17 && currentTime.getMinutes() >= 0)) { %>
                    <%  bgcolor="#FDECAA;"%>
                    <% textcolor='black'%>
                    <% cursor='pointer'%>
                  <% } else { %>
                   <% bgcolor="#EBEBEB;"%>
                   <% textcolor='#A7ADB9'%>
                  
                  <% } %>
                <% } else { %>
                  <%  bgcolor="#48BF84;"%>
                  <% textcolor="#fff;"%>
                  <% cursor='pointer'%>
                <% } %>
                <% if (cursor === 'pointer') { %>
                  data-toggle="modal" data-target="#managerModalRating"
                <% } %>
                
                  style="
                    display: flex;
                    flex-direction: row;
                    justify-content: center;
                    align-items: center;
                    font-weight:600;
                    cursor: <%=cursor%>;
                    margin: 10px;
                    height: 40px;
                  background-color:<%=bgcolor%>;
                  color:<%=textcolor%>;
                    border-radius: 12px;
                  "
onclick="<%= cursor === 'pointer' ? `sendData('${JSON.stringify(adminPerformanceList[i])}', '${adminPerformanceList[i].admin._id}','${date}')` : '' %>"
                >
            
             
                <% if (!adminPerformanceList[i].performanceRecord){ %>
                  <% if (performancedate.getTime() + millisecondsInDay < currentTime.getTime() ||currentTime.getHours() > 17 || (currentTime.getHours() === 17 && currentTime.getMinutes() >= 0)) { %>
                    <img src="../img/icons performance mgmt/desktop/d_eod_incomplete_big.svg"/> Rate without EOD 
                   <% }else { %>
                    <img src="../img/icons performance mgmt/desktop/d_eod_disabled_big.svg"/> EOD Not Submitted
                   <%}%> 
                 
                  <%}else if ( adminPerformanceList[i].performanceRecord.taskStatus.length < 4 && !adminPerformanceList[i].performanceRecord.taskStatus[3]) { %>
                  <% if (performancedate.getTime() + millisecondsInDay < currentTime.getTime() ||currentTime.getHours() > 17 || (currentTime.getHours() === 17 && currentTime.getMinutes() >= 0)) { %>
                 <img src="../img/icons performance mgmt/desktop/d_eod_incomplete_big.svg"/> Rate without EOD 
                  <% } else { %>
                    <img src="../img/icons performance mgmt/desktop/d_eod_disabled_big.svg"/> EOD Not Submitted
                  <% } %>
                <% } else { %>
                  <img src="../img/icons performance mgmt/desktop/d_eod_active_big.svg"/> Check EOD & Rate
               
                  <%}%>   
                </div>
                <a href="/project/<%=adminPerformanceList[i].admin._id%>" style="margin-top:-10px">
                  <div id="projectbutton<%=i%>" class="cardbutton" style="
                    display: flex;
              padding: 8px;
              justify-content: center;
              align-items: center;
              gap: 8px;
              align-self: stretch;
              border-radius: 12px;
              margin: 10px;
              height: 40px;
              border: 1px solid var(--surface-button-primary, #48BF84);
                   " >
                             <img src="../img/icons performance mgmt/desktop/project&task.svg" />Projects & Tasks
                           </div>
                          </a>
              </div>
              <%}%>

            
            </div>


            <div id="RatingReviewSystemBody">
              <%  ratingReviewList.map(item=>{ %>
                <% let adminPerformanceList=item.data.filter((employee)=>employee.ratingReview.status!='Pending');%>
            <% if(adminPerformanceList.length>0){%>
                <% const ratingeviewsDate = ChangeDate(item.date); %>
                <div style="color: #000;
             font-size: 20px;
             font-style: normal;
             font-weight: 700;
             line-height: 24px;margin:10px 0px; "><%=ratingeviewsDate%>
             </div>
           
            <div
            style="
            padding-top:5px;
               display: flex;
              flex-direction: row;
              justify-content: flex-start;
              flex-flow: wrap;
              margin-bottom: 20px;
            "
          >
    
                <% for(let i=0;i<adminPerformanceList.length;i++){%>
                  <% if(adminPerformanceList[i].ratingReview.status!='Pending'){%>
                <div
                  class="card"
                  style="
                    width: 320px;
                    background: #ffffff;
                    border: 1px solid #ececec;
                    border-radius: 20px;
                    margin:10px 10px;
                    overflow: hidden;
                  "
                >
                  <div
                    style="height: 60px;"
                    id="haderdiv"
                    class="<%= adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.taskStatus[3]? 'success' : adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.taskStatus[2] ? 'orange' :adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.taskStatus[1] ? 'task-color':'normal' %>">
                  
                    <div style="display: flex;
                    width:100%;
                    height: 100%;
                    align-items: flex-end;" >
                      <div style="height:100%;display: flex;
                      justify-content: center;
                      align-items: center"id='ratingdiv' class="<%=adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.rating > 0?' col-3 black' : 'col-3'%>">
                        <% if (adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.rating > 0) { %>
                          <%= adminPerformanceList[i].performanceRecord.rating %>
                        <% } %>
                        <img src="<%=adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.rating > 0?'../img/icons performance mgmt/desktop/d_star_full.svg':'../img/icons performance mgmt/desktop/d_star_empty.svg'%>" style="width: 20px; height: 20px; margin-left: 5px;margin-bottom:3px;" />
                      </div>
                      
                      <div class="col-6" style="display:flex;padding:10px 0px;">
                        <span style="font-size: 18px; font-weight: bold; margin:auto;" id="headertitle">
                          <% if (adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.taskStatus[3]) { %>
                            EOD <img src="../img/icons performance mgmt/desktop/d_header_eod_green.svg">
                          <% } else if (adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.taskStatus[2]) { %>
                            Noon <img src="../img/icons performance mgmt/desktop/d_header_noon_orange.svg">
                          <% } else if (adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.taskStatus[1]) { %>
                            Task <img src="../img/icons performance mgmt/desktop/d_header_task_blue.svg">
                          <% } else if (adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.taskStatus[0]) { %>
                            Sign In <img src="../img/icons performance mgmt/desktop/d_header_signin.svg">
                          <% } else { %>
                            No Status <img src="../img/icons performance mgmt/desktop/d_header_no_status.svg">
                          <% } %>
                        </span>
                        
                      </div>
                      <% let backgrooundColor=adminPerformanceList[i].ratingReview.status=='Pending'?'var(--pill-text-blue, #3B82F6)':'#48BF84'%>
                      <div style="height:100%;display: flex;
                      justify-content: center;
                      background: <%=backgrooundColor%>;
                      align-items: center"id='ratingdiv' class="col-3" >
                        <img src="../img/icons performance mgmt/desktop/ratingReview.svg" style="width: 20px; height: 20px; margin-left: 5px;margin-bottom:3px;" />
                      </div>
                    </div>
                  </div>
                  <div>
                    <div style="display: flex; gap: 20px; margin: 10px;justify-content: space-between;
                    align-items: center;">
                      <div>
                        <img
                          src=" <%= adminPerformanceList[i].admin.image %>"
                          id="userprofile"
                          style="
                            width: 64px;
                            height: 64px;
                            border-radius: 61.2787px;
                          "
                        />
                      </div>
                      <div
                        style="
                          width: 161.36px;
                          height: 49.5px;
                          font-style: normal;
                          font-weight: 700;
                          font-size: 18px;
                          line-height: 25px;
                          display: flex;
                          align-items: center;
                          color: #181818;
                        "
                        id="namediv"
                      >
                      <%= adminPerformanceList[i].admin.firstName %> <%= adminPerformanceList[i].admin.lastName %>
                      </div>
                      <%if(adminPerformanceList[i].performanceRecord){%>
                      <div style="margin-right: 20px ;background: #F7F7F7;width:21px;height:21px;color:black;border-radius: 20px;">
                        <a  href="/performanceBoard/<%= adminPerformanceList[i].performanceRecord.employeeID %>">
                        <img src="../img/icons performance mgmt/desktop/d_right_chevron_big.svg"/>
                      </a>
                      </div>
                      <%}%>
                    </div>
                    <div id="container<%=5000+i%>" class="containers" style="padding:2px 10px;">
                      <div style="display: flex;
                      margin: 10px;
                      flex-direction: row;
                      justify-content: space-between;
                      flex-wrap: wrap;">
                        <div style="display: flex; gap: 5px">
                          <div><img src="<%= adminPerformanceList[i].performanceRecord&&adminPerformanceList[i].performanceRecord.taskStatus[0] ? '../img/icons performance mgmt/desktop/d_signin_done_big.svg' : '../img/icons performance mgmt/desktop/d_signin_done_disabled_big.svg' %>" /></div>
                          <div class="text-black">Sign In</div>
                        </div>
                        <div>
                          <h6   class="<%= adminPerformanceList[i].performanceRecord&&adminPerformanceList[i].performanceRecord.taskStatus[0] ? 'text-black' : 'text-normal' %>"><%= adminPerformanceList[i].performanceRecord&&adminPerformanceList[i].performanceRecord.taskStatus[0] ? 'Done' : 'Incomplete' %></h6>
                        </div>
                        
                      </div>
                      <div style="display: flex;
                      margin: 10px;
                      flex-direction: row;
                      justify-content: space-between;
                      flex-wrap: wrap;">
                        <div style="display: flex; flex-direction: row; gap: 5px">
                          <div><img src="<%= adminPerformanceList[i].performanceRecord&&adminPerformanceList[i].performanceRecord.taskStatus[1] ? '../img/icons performance mgmt/desktop/d_tab_tasks_big.svg' : '../img/icons performance mgmt/desktop/d_tab_tasks_disabled_big.svg' %>" /></div>
                          <div class="text-black">Tasks</div>
                        </div>
                        <h6 class="<%= adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.taskStatus[1] ? 'green' : 'text-disabled' %>">
                          <% if (adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.links[1]) { %>
                            <a href="<%= adminPerformanceList[i].performanceRecord.links[1] %>"class='green' target="_blank">Check</a>
                          <% } else { %>
                            Check
                          <% } %>
                        </h6>
                      </div>
                      <div style="display: flex;
                      margin: 10px;
                      flex-direction: row;
                      justify-content: space-between;
                      flex-wrap: wrap;">
                        <div style="display: flex; flex-direction: row;gap:5px">
                          <div><img src="<%= adminPerformanceList[i].performanceRecord&&adminPerformanceList[i].performanceRecord.taskStatus[2] ? '../img/icons performance mgmt/desktop/d_noon_done_big.svg' : '../img/icons performance mgmt/desktop/d_noon_done_disabled_big.svg' %>" /></div>
                          <div class="text-black">Noon Update</div>
                        </div>
                        <h6 class="<%= adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.taskStatus[2] ? 'green' : 'text-disabled' %>">
                          <% if (adminPerformanceList[i].performanceRecord && adminPerformanceList[i].performanceRecord.links[2]) { %>
                            <a href="<%= adminPerformanceList[i].performanceRecord.links[2] %>"class='green' target="_blank">Check</a>
                          <% } else { %>
                            Check
                          <% } %>
                        </h6>
                        
                      </div>
                      
                    </div>
                  </div>
                              <% let linksforsending=JSON.stringify(adminPerformanceList[i].performanceRecord.links) %>
                  <div id="cardbutton<%= 5000 + i %>" class="cardbutton" style="
                    display: flex;
                    flex-direction: row;
                    justify-content: center;
                    align-items: center;
                    font-weight: 600;
                    cursor: pointer;
                    margin: 10px;
                    height: 40px;
                    background-color: #48BF84;
                    color: white;
                    border-radius: 12px;"
                    data-target="#review-rating-modal"
                    data-toggle="modal"
                  
                    onclick="SetContentToModal(
                    '<%= adminPerformanceList[i].ratingReview.employeeId %>', '<%= adminPerformanceList[i].ratingReview.date %>'
                   )">
    
                    <img src="../img/icons performance mgmt/desktop/d_eod_active_big.svg"/> Check & Review
                </div>
                </div>
                <%}%>
                <%}%>
             
               
    
                
                </div>
                <%}%>
                <%})%>
              </div>
          </div>
        </div>
      </div>
    </div>
   
   <!-- Employee Satisfaction model -->
   <div class="modal fade" id="EmployeeSatisfactionModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl" role="document">
      <div class="modal-content" style="font-weight: 300;">
        <div class="modal-header" style="padding: 0.4em 1.25em;">
          <h5 class="modal-title" id="exampleModalLabel">Employee satisfaction</h5>
          <img src="../img/icons performance mgmt/desktop/close_40x40.svg" data-dismiss="modal" alt="Close">
        </div>
        <div class="modal-body">
          <div style="display: flex; justify-content: space-between; align-items: center; width: 100%;margin-bottom: 20px;">
            <div style="color: var(--gray-900, #101828);
              font-size: 16px;
              font-style: normal;
              font-weight: 500;
              width: 70%;
              line-height: 20px;">
              Review and address employee feedback to foster a positive work environment and continuous improvement.
            </div>
            <select style="display: flex;
              padding: 12px 16px;
              justify-content: center;
              align-items: center;
              gap: 8px;
              border-radius: 8px;
              border: 1px solid var(--stroke-secondary, #DCDCDC);"
              id="RatingReviewStatusModal" onchange="filterItemsSatisfactionModal()">
              <option value="all" selected> All</option>
              <option value="true"  >Satisfied</option>
              <option value="false">Not Satisfied</option>
            </select>
          </div>
          <div style="width: 100%;">
            <table style="width: 100%;">
              <thead style="border-top: 1px solid #DCDCDC;
                border-bottom: 1px solid #DCDCDC;
                background: #F9FAFB;
                display: flex;
                height: 44px;
                align-items: center;
                gap: 12px;
                align-self: stretch;">
                <tr style="display: flex;justify-content: space-between;width:100%;">
                  <th style="  display: flex;padding: 12px 24px; align-items: center;font-weight: 300;">Name of the employee</th>
                  <th style="  display: flex;padding: 12px 24px; align-items: center;font-weight: 300;">Date</th>
                  <th style="  display: flex;padding: 12px 24px; align-items: center;font-weight: 300;">  Ratings</th>
                  <th style="  display: flex;padding: 12px 24px; align-items: center;font-weight: 300;">Response of the review</th>
                  <th style="  display: flex;padding: 12px 24px; align-items: center;font-weight: 300;">Comments</th>
                </tr>
              </thead>
              <tbody style="color:black" id="SatisfactionEmployeeModal">
                <%
  let AdminPerformanceContent = [];
  ratingReviewList.forEach(item => {
    let adminPerformanceContent = item.data.filter(employee => employee.ratingReview.isSatisfied != '')
    AdminPerformanceContent = AdminPerformanceContent.concat(adminPerformanceContent);
  });
%>
             
                  <% for (let i = 0; i < AdminPerformanceContent.length; i++) { %>
                    <% let item = AdminPerformanceContent[i]; %>
                    <tr style="display: flex;justify-content: space-between;width:100%;display: flex;
                    height: 72px;
                    border-bottom: 1px solid #DCDCDC;
                    align-items: center;
                    gap: 12px;
                    align-self: stretch;">
                      <td style="display: flex;gap:10px;align-items: center; padding: 16px 24px;width:22%;overflow:hidden">
                        <img src="<%= item.admin.image %>"
                          style="display: flex; width: 40px; height: 40px; flex-direction: column;
                            justify-content: center; align-items: center; border-radius: 200px;">
                        <%= item.admin.displayName %>
                      </td>
                      <td style="display: flex; align-items: center; padding: 16px 24px;width:15%;overflow:hidden">
                        <%= ChangeDate(item.ratingReview.date) %>
                      </td>
                      <td style="display: flex; align-items: center; gap: 5px; padding: 16px 24px;width:10%;overflow:hidden">
                        <%= item.performanceRecord.rating %>
                        <i class="fas fa-star" size="24" style="color: #FACC15;"></i>
                      </td>
                      <td style="display: flex; align-items: center; padding: 16px 24px;width:24%;overflow:hidden;justify-content: center;">
                        <%if(item.ratingReview.isSatisfied==''){%>
                          <div style="font-size: 16px;
                          font-style: normal;
                          font-weight: 700;">Not reviewed</div>
                        <%}else if(item.ratingReview.isSatisfied=='true'){%>
                          <div style="color:#48BF84;font-size: 16px;
                          font-style: normal;
                          font-weight: 700;">Yes, I am satisfied</div>
                          <%}else{%>
                          <div style="color:#FF6565;font-size: 16px;
                          font-style: normal;
                          font-weight: 700;">No, I would like to discuss.</div>
                          <%}%>
                      </td>
                      <td style="display: flex; align-items: center;; padding: 16px 24px;width:15%;font-size: 14px;overflow: hidden;">
                        <%= item.ratingReview.feedbackEmployee %>
                      </td>
                    </tr>
                  <% } %>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
  

    </div>


    <%- include('partials/manager-rating-feedback'); -%>
    <%- include('partials/review_request'); -%>
<script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>

<script>
  function changeposition() {
    var icon = document.getElementById("icon");
    var container = document.getElementById("navcontainer");

    icon.classList.toggle("fa-angle-down");
    icon.classList.toggle("fa-angle-up");

    if (container.style.display === "flex") {
      container.style.display = "none"; // Show the container
    } else {
      container.style.display = "flex"; // Hide the container
    }
  }
  function ChangeArrow(i) {

    var icon = document.getElementById("icons" + i);

    var container = document.getElementById("container" + i);
    var cardbutton = document.getElementById("cardbutton" + i);

    icon.classList.toggle("fa-angle-down");
    icon.classList.toggle("fa-angle-up");

    if (container.style.display === "block") {
      container.style.display = "none"; // Hide the container
      cardbutton.style.display = "none"; // Hide the container
    } else {
      container.style.display = "block"; // Show the container

      cardbutton.style.display = "flex"; // Show the container
    }
  }


  

  let dateInput=document.getElementById('dateInput')
  dateInput.addEventListener('blur', async () => {
    date = dateInput.value;
   
    const managementUrl = `/management/${date}`;
    window.location.href = managementUrl;
  });
  let ratingReviewitems = `<%-JSON.stringify(ratingReviewList)%>`
  ratingReviewitems = JSON.parse(ratingReviewitems);

  function filterItems() {
    const selectedDate = document.getElementById('RatingReviewSystemDate').value;
    const selectedStatus = document.getElementById('RatingReviewStatus').value;
   
    const filteredItems = ratingReviewitems.flatMap(item => item.data.filter(subItem => {
      const ratingeviewsDate = subItem.ratingReview.date;
   
      return (
        (!selectedDate || ratingeviewsDate === selectedDate) &&
        (selectedStatus === 'all' || subItem.ratingReview.status.toLowerCase() === selectedStatus.toLowerCase())
      );
    }));
    const ReviewListgroupedByDate = [];

    filteredItems.forEach(subItem => {
      const date = subItem.ratingReview.date;
      const existingEntry = ReviewListgroupedByDate.find(
        entry => entry.date === date
      );

      if (existingEntry) {
        existingEntry.data.push(subItem);
      } else {
        ReviewListgroupedByDate.push({
          date: date,
          data: [subItem],
        });
      }
    });

    // Now ReviewListgroupedByDate contains the grouped data
  
    displayFilteredItems(ReviewListgroupedByDate);
  }

  function filterItemsSatisfactionModal() {
  
    const selectedStatus = document.getElementById('RatingReviewStatusModal').value;
  
    const filteredItems = ratingReviewitems.flatMap(item => item.data.filter(subItem => {
   
      return (
       
       ((selectedStatus === 'all' && subItem.ratingReview.isSatisfied!='') || subItem.ratingReview.isSatisfied.toLowerCase() === selectedStatus.toLowerCase())
      );
    }));
   
   
    displayFilteredItemsModal(filteredItems);
  }


  function displayFilteredItems(items) {
    const RatingReviewSystemBody = document.getElementById('RatingReviewSystemBody');
    RatingReviewSystemBody.innerHTML = '';

    items.forEach(item => {
      const ratingeviewsDate = ChangeDate(item.date);
      const adminPerformanceList = item.data;

      const filteredHtml = `
      <div style="color: #000;
         font-size: 20px;
         font-style: normal;
         font-weight: 700;
         line-height: 24px;margin:10px 0px; ">${ratingeviewsDate}</div>
      <div style="padding-top:5px;
           display: flex;
          flex-direction: row;
          justify-content: flex-start;
          flex-flow: wrap;
          margin-bottom: 20px;">
        ${adminPerformanceList.map(subItem => {
        return   `
          <div class="card" style="width: 320px;
                background: #ffffff;
                border: 1px solid #ececec;
                border-radius: 20px;
                margin:10px 10px;
                overflow: hidden;">
            
            <div style="height: 60px;"
                id="haderdiv"
                class="${subItem.performanceRecord && subItem.performanceRecord.taskStatus[3] ? 'success' : subItem.performanceRecord && subItem.performanceRecord.taskStatus[2] ? 'orange' : subItem.performanceRecord && subItem.performanceRecord.taskStatus[1] ? 'task-color' : 'normal'}">
              
                <div style="display: flex;
                width:100%;
                height: 100%;
                align-items: flex-end;">
                  <div style="height:100%;display: flex;
                  justify-content: center;
                  align-items: center"id='ratingdiv' class="${subItem.performanceRecord && subItem.performanceRecord.rating > 0 ? 'col-3 black' : 'col-3'}">
                    ${subItem.performanceRecord && subItem.performanceRecord.rating > 0 ? subItem.performanceRecord.rating : ''}
                    <img src="${subItem.performanceRecord && subItem.performanceRecord.rating > 0 ? '../img/icons performance mgmt/desktop/d_star_full.svg' : '../img/icons performance mgmt/desktop/d_star_empty.svg'}" style="width: 20px; height: 20px; margin-left: 5px;margin-bottom:3px;" />
                  </div>
                  
                  <div class="col-6" style="display:flex;padding:10px 0px;">
                    <span style="font-size: 18px; font-weight: bold; margin:auto;" id="headertitle">
                      ${subItem.performanceRecord && subItem.performanceRecord.taskStatus[3] ? `
                        EOD <img src="../img/icons performance mgmt/desktop/d_header_eod_green.svg">
                      ` : subItem.performanceRecord && subItem.performanceRecord.taskStatus[2] ? `
                        Noon <img src="../img/icons performance mgmt/desktop/d_header_noon_orange.svg">
                      ` : subItem.performanceRecord && subItem.performanceRecord.taskStatus[1] ? `
                        Task <img src="../img/icons performance mgmt/desktop/d_header_task_blue.svg">
                      ` : subItem.performanceRecord && subItem.performanceRecord.taskStatus[0] ? `
                        Sign In <img src="../img/icons performance mgmt/desktop/d_header_signin.svg">
                      ` : `
                        No Status <img src="../img/icons performance mgmt/desktop/d_header_no_status.svg">
                      `}
                    </span>
                    
                  </div>
                  <div style="height:100%;display: flex;
                  justify-content: center;
                  background: ${subItem.ratingReview.status == 'Pending' ? 'var(--pill-text-blue, #3B82F6)' : '#48BF84'};
                  align-items: center"id='ratingdiv' class="col-3">
                    <img src="../img/icons performance mgmt/desktop/ratingReview.svg" style="width: 20px; height: 20px; margin-left: 5px;margin-bottom:3px;" />
                  </div>
                </div>
              </div>
            
              <div>
                <div style="display: flex; gap: 20px; margin: 10px;justify-content: space-between;
    align-items: center;">
                  <div>
                    <img
                      src="${subItem.admin.image}"
                      id="userprofile"
                      style="width: 64px;
                        height: 64px;
                        border-radius: 61.2787px;"
                    />
                  </div>
                  <div
                    style="width: 161.36px;
                      height: 49.5px;
                      font-style: normal;
                      font-weight: 700;
                      font-size: 18px;
                      line-height: 25px;
                      display: flex;
                      align-items: center;
                      color: #181818;"
                    id="namediv"
                  >
                    ${subItem.admin.firstName} ${subItem.admin.lastName}
                  </div>
                  ${subItem.performanceRecord ? `
                    <div style="margin-right: 20px ;background: #F7F7F7;width:21px;height:21px;color:black;border-radius: 20px;">
                      <a href="/performanceBoard/${subItem.performanceRecord.employeeID}">
                        <img src="../img/icons performance mgmt/desktop/d_right_chevron_big.svg"/>
                      </a>
                    </div>
                  ` : ''}
                </div>
                
                <div class="containers" style="padding: 2px 10px;">
      <div style="display: flex;
        margin: 10px;
        flex-direction: row;
        justify-content: space-between;
        flex-wrap: wrap;">
        <div style="display: flex; gap: 5px">
          <div><img src="${subItem.performanceRecord && subItem.performanceRecord.taskStatus[0] ? '../img/icons performance mgmt/desktop/d_signin_done_big.svg' : '../img/icons performance mgmt/desktop/d_signin_done_disabled_big.svg'}" /></div>
          <div class="text-black">Sign In</div>
        </div>
        <div>
          <h6 class="${subItem.performanceRecord && subItem.performanceRecord.taskStatus[0] ? 'text-black' : 'text-normal'}">${subItem.performanceRecord && subItem.performanceRecord.taskStatus[0] ? 'Done' : 'Incomplete'}</h6>
        </div>
      </div>
      <div style="display: flex;
        margin: 10px;
        flex-direction: row;
        justify-content: space-between;
        flex-wrap: wrap;">
        <div style="display: flex; flex-direction: row; gap: 5px">
          <div><img src="${subItem.performanceRecord && subItem.performanceRecord.taskStatus[1] ? '../img/icons performance mgmt/desktop/d_tab_tasks_big.svg' : '../img/icons performance mgmt/desktop/d_tab_tasks_disabled_big.svg'}" /></div>
          <div class="text-black">Tasks</div>
        </div>
        <h6 class="${subItem.performanceRecord && subItem.performanceRecord.taskStatus[1] ? 'green' : 'text-disabled'}">
          ${subItem.performanceRecord && subItem.performanceRecord.links[1] ? `<a href="${subItem.performanceRecord.links[1]}" class="green" target="_blank">Check</a>` : 'Check'}
        </h6>
      </div>
      <div style="display: flex;
        margin: 10px;
        flex-direction: row;
        justify-content: space-between;
        flex-wrap: wrap;">
        <div style="display: flex; flex-direction: row; gap: 5px">
          <div><img src="${subItem.performanceRecord && subItem.performanceRecord.taskStatus[2] ? '../img/icons performance mgmt/desktop/d_noon_done_big.svg' : '../img/icons performance mgmt/desktop/d_noon_done_disabled_big.svg'}" /></div>
          <div class="text-black">Noon Update</div>
        </div>
        <h6 class="${subItem.performanceRecord && subItem.performanceRecord.taskStatus[2] ? 'green' : 'text-disabled'}">
          ${subItem.performanceRecord && subItem.performanceRecord.links[2] ? `<a href="${subItem.performanceRecord.links[2]}" class="green" target="_blank">Check</a>` : 'Check'}
        </h6>
      </div>
    </div>

            
              <div class="cardbutton" style="
                display: flex;
                flex-direction: row;
                justify-content: center;
                align-items: center;
                font-weight: 600;
                cursor: pointer;
                margin: 10px;
                height: 40px;
                background-color: #48BF84;
                color: white;
                border-radius: 12px;"
                data-target="#review-rating-modal"
                data-toggle="modal"
              
                onclick="SetContentToModal(
                '${subItem.ratingReview.employeeId}', '${subItem.ratingReview.date}')">

                <img src="../img/icons performance mgmt/desktop/d_eod_active_big.svg"/> Check & Review
              </div>
            </div>
          </div>
        `}).join('')}
      </div>
    `;

      RatingReviewSystemBody.innerHTML += filteredHtml;
    });
  }
  function displayFilteredItemsModal(items) {
  let RatingReviewSystemBody = document.getElementById('SatisfactionEmployeeModal');
  RatingReviewSystemBody.innerHTML = '';

  items.forEach(item => {
    let ratingeviewsDate = ChangeDate(item.date);
    let adminPerformanceList = item.data;

    let isSatisfiedHtml = '';
    if (item.ratingReview.isSatisfied === '') {
      isSatisfiedHtml = `<div style="font-size: 16px;
                          font-style: normal;
                          font-weight: 700;">Not reviewed</div>`
     } else  if (item.ratingReview.isSatisfied === 'true') {
      isSatisfiedHtml = `
        <div style="color:#48BF84;font-size: 16px;font-style: normal;font-weight: 700;">Yes, I am satisfied</div>
      `;
    } else {
      isSatisfiedHtml = `
        <div style="color:#FF6565;font-size: 16px;font-style: normal;font-weight: 700;">No, I would like to discuss.</div>
      `;
    }

    let filteredHtml = `
      <tr style="display: flex;justify-content: space-between;width:100%;display: flex;
                height: 72px;
                border-bottom: 1px solid #DCDCDC;
                align-items: center;
                gap: 12px;
                align-self: stretch;">
        <td style="display: flex;gap:10px;align-items: center; padding: 16px 24px;width:22%;overflow:hidden">
          <img src="${item.admin.image}"
            style="display: flex; width: 40px; height: 40px; flex-direction: column;
              justify-content: center; align-items: center; border-radius: 200px;">
          ${item.admin.displayName }
        </td>
        <td style="display: flex; align-items: center; padding: 16px 24px;width:15%;overflow:hidden">
          ${ChangeDate(item.ratingReview.date)}
        </td>
        <td style="display: flex; align-items: center; gap: 5px; padding: 16px 24px;width:10%;overflow:hidden">
          ${ item.performanceRecord.rating }
          <i class="fas fa-star" size="24" style="color: #FACC15;"></i>
        </td>
        <td style="display: flex; align-items: center; padding: 0px 24px;width:24%;overflow:hidden;justify-content: center;">
          ${isSatisfiedHtml}
        </td>
        <td style="display: flex; align-items: center;; padding: 16px 24px;width:15%;font-size: 14px;overflow: hidden;">
          ${item.ratingReview.feedbackEmployee }
        </td>
      </tr>
    `;

    RatingReviewSystemBody.innerHTML += filteredHtml;
  });
}

function showIcons(id) {
    const box = document.getElementById(id);
    box.style.display = 'flex';
    }

    function removeIcons(id) {
    const box = document.getElementById(id);
    box.style.display = 'none';
    }
   async function DeleteRaiseIssueOnLeave(id,boxid)
    {
      try{
      let res=await  fetch(`/raiseIssueOnLeave/${id}`,{
        method: 'DELETE',
      headers: {'Content-Type': 'application/json'}
      });
      document.getElementById(boxid).remove();
     // location.reload();
    }
    catch(error) {
      console.error(error);
    }
    }

</script>
  
    <script src="../js/purpose.core.js"></script>

    <script src="../libs/autosize/dist/autosize.min.js"></script>
    <script src="../libs/bootstrap-tagsinput/dist/bootstrap-tagsinput.min.js"></script>
    <script src="../libs/progressbar.js/dist/progressbar.min.js"></script>
    <script src="../libs/apexcharts/dist/apexcharts.min.js"></script>
    <script src="../libs/moment/min/moment.min.js"></script>

    <script src="//cdn.quilljs.com/1.3.6/quill.js"></script>
    <script src="../libs/fullcalendar/dist/fullcalendar.min.js"></script>
   
    <script src="../js/purpose.js"></script>

    <script src="../js/demo.js"></script>
  </body>
</html>
